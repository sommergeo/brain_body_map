<!DOCTYPE html>
<html>
<head>
	<title>Brain & body size</title>
	<meta name="author" content="Christian Sommer">
	
	<link rel="stylesheet" href="css/leaflet.css">
	<link rel="stylesheet" href="css/MarkerCluster.css">
    <link rel="stylesheet" href="css/MarkerCluster.Default.css">
	<script src="js/leaflet.js"></script>
	<script src="js/leaflet.markercluster.js"></script>
	<script src="js/style_expressions.js"></script>
	<script src="data/MPH.js"></script>
	<script src="data/NT.js"></script>
	<script src="data/LPH.js"></script>
	
	<style>
	html, body, #map {
		width: 100%;
		height: 100%;
		padding: 0;
		margin: 0;
	}
	</style>
	
	<style>#map { width: 800px; height: 500px; }
		.info { padding: 6px 8px; font: 14px/16px Arial, Helvetica, sans-serif; background: white; background: rgba(255,255,255,0.8); box-shadow: 0 0 15px rgba(0,0,0,0.2); border-radius: 5px; } .info h4 { margin: 0 0 5px; color: #777; }
		.legend { text-align: left; line-height: 18px; color: #555; } .legend i { width: 18px; height: 18px; float: left; margin-right: 8px; opacity: 0.7; }
		.th, td {border-bottom: 1px solid #ddd; text-align: center;}
	</style>
	
</head>

<body>

<!--<div id="mapid" style="width: 600px; height: 400px; position: relative;"></div> -->
<div id="mapid" style="width: 100%; height: 100%; padding: 0; margin: 0;"></div>
<script src="gullies.geojson"></script>


<script>

	// Create Leaflet map
	var map = L.map('mapid').setView([28, 80], 3);
	map.attributionControl.addAttribution('<a href="http://www.roceeh.net" target="_blank">ROCEEH</a>, Data: tba (M. Will), Map: CC-BY-SA 4.0 by <a rel="author" href="https://github.com/sommergeo">Ch. Sommer</a> | <a href="https://thenounproject.com/search/?q=brain&creator=1145943&i=2805277" target="_blank">Brain</a> icon by Adrien Coquet and <a href="https://thenounproject.com/search/?q=man&i=347814" target="_blank">Body</a> icon by Brad Avison from the Noun Project');
	
	
	// Add basemaps
	// basemap 1:
	var osm_basemap = L.tileLayer('https://{s}.tile.openstreetmap.de/tiles/osmde/{z}/{x}/{y}.png', {
		attribution: '<a href="http://www.openstreetmap.org/copyright">Â© OpenStreetMap-Contributors</a>'
	}).addTo(map);
	

	// Pop-Up
    function popUpFunction(feature, layer) {
        var popupContent = "<b>Name: </b>"+ feature.properties.ID +
			"<br><b>Type: </b>"+ feature.properties.layer +
			"<br><b>Taxonomy: </b>"+ feature.properties['Taxonomy'] +
			"<br><b>Age group: </b>"+ feature.properties['Age group'] +
			"<br><b>Latitude: </b>"+ feature.properties['Y-coordina'] +
			"<br><b>Longitude: </b>"+ feature.properties['X-coordina'];
        layer.bindPopup(popupContent);
    }


	// Styling
	function style_layer(feature) {
            var context = {
                feature: feature,
                variables: {}
            };
            // Start of if blocks and style check logic
            if (exp_Br1(context)) {
                  return {
                pane: 'pane_allfinds',
        rotationAngle: 0.0,
        rotationOrigin: 'center center',
        icon: L.icon({
            iconUrl: 'markers/noun_Brain_2805277.svg',
            iconSize: [110, 10]
        }),
                interactive: true,
            };
                }
                else if (exp_Br2(context)) {
                  return {
                pane: 'pane_allfinds',
        rotationAngle: 0.0,
        rotationOrigin: 'center center',
        icon: L.icon({
            iconUrl: 'markers/noun_Brain_2805277.svg',
            iconSize: [12, 12]
        }),
                interactive: true,
            };
                }
                else if (exp_Br3(context)) {
                  return {
                pane: 'pane_allfinds',
        rotationAngle: 0.0,
        rotationOrigin: 'center center',
        icon: L.icon({
            iconUrl: 'markers/noun_Brain_2805277.svg',
            iconSize: [15, 15]
        }),
                interactive: true,
            };
                }
                else if (exp_Br4(context)) {
                  return {
                pane: 'pane_allfinds',
        rotationAngle: 0.0,
        rotationOrigin: 'center center',
        icon: L.icon({
            iconUrl: 'markers/noun_Brain_2805277.svg',
            iconSize: [18, 18]
        }),
                interactive: true,
            };
                }
                else if (exp_Br5(context)) {
                  return {
                pane: 'pane_allfinds',
        rotationAngle: 0.0,
        rotationOrigin: 'center center',
        icon: L.icon({
            iconUrl: 'markers/noun_Brain_2805277.svg',
            iconSize: [21, 21]
        }),
                interactive: true,
            };
                }
                else if (exp_Br6(context)) {
                  return {
                pane: 'pane_allfinds',
        rotationAngle: 0.0,
        rotationOrigin: 'center center',
        icon: L.icon({
            iconUrl: 'markers/noun_Brain_2805277.svg',
            iconSize: [24, 24]
        }),
                interactive: true,
            };
                }
                else if (exp_Br7(context)) {
                  return {
                pane: 'pane_allfinds',
        rotationAngle: 0.0,
        rotationOrigin: 'center center',
        icon: L.icon({
            iconUrl: 'markers/noun_Brain_2805277.svg',
            iconSize: [27, 27]
        }),
                interactive: true,
            };
                }
                else if (exp_Br8(context)) {
                  return {
                pane: 'pane_allfinds',
        rotationAngle: 0.0,
        rotationOrigin: 'center center',
        icon: L.icon({
            iconUrl: 'markers/noun_Brain_2805277.svg',
            iconSize: [30, 30]
        }),
                interactive: true,
            };
                }
                else if (exp_Bo1(context)) {
                  return {
                pane: 'pane_allfinds',
        rotationAngle: 0.0,
        rotationOrigin: 'center center',
        icon: L.icon({
            iconUrl: 'markers/noun_Man_347814.svg',
            iconSize: [10, 10]
        }),
                interactive: true,
            };
                }
                else if (exp_Bo2(context)) {
                  return {
                pane: 'pane_allfinds',
        rotationAngle: 0.0,
        rotationOrigin: 'center center',
        icon: L.icon({
            iconUrl: 'markers/noun_Man_347814.svg',
            iconSize: [12, 12]
        }),
                interactive: true,
            };
                }
                else if (exp_Bo3(context)) {
                  return {
                pane: 'pane_allfinds',
        rotationAngle: 0.0,
        rotationOrigin: 'center center',
        icon: L.icon({
            iconUrl: 'markers/noun_Man_347814.svg',
            iconSize: [15, 15]
        }),
                interactive: true,
            };
                }
                else if (exp_Bo4(context)) {
                  return {
                pane: 'pane_allfinds',
        rotationAngle: 0.0,
        rotationOrigin: 'center center',
        icon: L.icon({
            iconUrl: 'markers/noun_Man_347814.svg',
            iconSize: [18, 18]
        }),
                interactive: true,
            };
                }
                else if (exp_Bo5(context)) {
                  return {
                pane: 'pane_allfinds',
        rotationAngle: 0.0,
        rotationOrigin: 'center center',
        icon: L.icon({
            iconUrl: 'markers/noun_Man_347814.svg',
            iconSize: [21, 21]
        }),
                interactive: true,
            };
                }
                else if (exp_Bo6(context)) {
                  return {
                pane: 'pane_allfinds',
        rotationAngle: 0.0,
        rotationOrigin: 'center center',
        icon: L.icon({
            iconUrl: 'markers/noun_Man_347814.svg',
            iconSize: [24, 24]
        }),
                interactive: true,
            };
                }
                else if (exp_Bo7(context)) {
                  return {
                pane: 'pane_allfinds',
        rotationAngle: 0.0,
        rotationOrigin: 'center center',
        icon: L.icon({
            iconUrl: 'markers/noun_Man_347814.svg',
            iconSize: [27, 27]
        }),
                interactive: true,
            };
                }
                else if (exp_Bo8(context)) {
                  return {
                pane: 'pane_allfinds',
        rotationAngle: 0.0,
        rotationOrigin: 'center center',
        icon: L.icon({
            iconUrl: 'markers/noun_Man_347814.svg',
            iconSize: [30, 30]
        }),
                interactive: true,
            };
                }
            else {
                return {fill: false, stroke: false};
            }
        }
	
	// Data
		// Map Pane
		map.createPane('pane_allfinds');
        map.getPane('pane_allfinds').style.zIndex = 401;
        map.getPane('pane_allfinds').style['mix-blend-mode'] = 'normal';
		
		// MPH
	    var layer_MPH = new L.geoJson(json_MPH, {
            attribution: '',
            interactive: true,
            dataVar: 'json_MPH',
            layerName: 'layer_MPH',
            pane: 'pane_allfinds',
            onEachFeature: popUpFunction,
            pointToLayer: function (feature, latlng) {
                var context = {
                    feature: feature,
                    variables: {}
                };
                return L.marker(latlng, style_layer(feature));
            },
        });
		//layer_MPH.addTo(map);
		
		// NT
	    var layer_NT = new L.geoJson(json_NT, {
            attribution: '',
            interactive: true,
            dataVar: 'json_NT',
            layerName: 'layer_NT',
            pane: 'pane_allfinds',
            onEachFeature: popUpFunction,
            pointToLayer: function (feature, latlng) {
                var context = {
                    feature: feature,
                    variables: {}
                };
                return L.marker(latlng, style_layer(feature));
            },
        });
		//layer_NT.addTo(map);
		
		// NT
	    var layer_LPH = new L.geoJson(json_LPH, {
            attribution: '',
            interactive: true,
            dataVar: 'json_LPH',
            layerName: 'layer_LPH',
            pane: 'pane_allfinds',
            onEachFeature: popUpFunction,
            pointToLayer: function (feature, latlng) {
                var context = {
                    feature: feature,
                    variables: {}
                };
                return L.marker(latlng, style_layer(feature));
            },
        });
		//layer_LPH.addTo(map);
		
        
	// Cluster	
		// MPH
		var cluster_MPH = new L.MarkerClusterGroup({showCoverageOnHover: false,
           spiderfyDistanceMultiplier: 1,
		   zoomToBoundsOnClick: false});
        cluster_MPH.addLayer(layer_MPH);
		cluster_MPH.on('clusterclick', function (a) {a.layer.spiderfy();});
		//bounds_group.addLayer(layer_MPH);
        cluster_MPH.addTo(map);
		
		//NT
		var cluster_NT = new L.MarkerClusterGroup({showCoverageOnHover: false,
           spiderfyDistanceMultiplier: 1,
		   zoomToBoundsOnClick: false});
        cluster_NT.addLayer(layer_NT);
		cluster_NT.on('clusterclick', function (a) {a.layer.spiderfy();});
		//bounds_group.addLayer(layer_NT);
        //cluster_MPH.addTo(map);
	
		//LPH
		var cluster_LPH = new L.MarkerClusterGroup({showCoverageOnHover: false,
           spiderfyDistanceMultiplier: 1,
		   zoomToBoundsOnClick: false});
        cluster_LPH.addLayer(layer_LPH);
		cluster_LPH.on('clusterclick', function (a) {a.layer.spiderfy();});
		//bounds_group.addLayer(layer_LPH);
        //cluster_LPH.addTo(map);
	
	// Control
		//Layer Control
		var baseMaps = {};
		var overlay = {'Middle Pleistocene Homo': cluster_MPH,
			'Neanderthals': cluster_NT,
			'Late Pleistocene Homo sapiens': cluster_LPH,}
		L.control.layers(baseMaps,overlay,{collapsed:false}).addTo(map);
		
		// Legend
		var legend = L.control({position: 'bottomright'});
		legend.onAdd = function (map) {
		
			var div = L.DomUtil.create('div', 'info legend');
			div.innerHTML +=
			'<h4>Legend</h1><br>' +
			//'<b>Age classes:</b><br>' +
			//'1 <img src="markers/noun_Brain_2805277.svg" alt="Brain size 1" width="10" height="10"> <img src="markers/noun_Man_347814.svg" alt="Brain size 1" width="10" height="10"><br>' +
			//'2 <img src="markers/noun_Brain_2805277.svg" alt="Brain size 2" width="12" height="12"> <img src="markers/noun_Man_347814.svg" alt="Body size 2" width="12" height="12"><br>' +
			//'3 <img src="markers/noun_Brain_2805277.svg" alt="Brain size 3" width="15" height="15"> <img src="markers/noun_Man_347814.svg" alt="Body size 3" width="15" height="15"><br>' +
			//'4 <img src="markers/noun_Brain_2805277.svg" alt="Brain size 4" width="18" height="18"> <img src="markers/noun_Man_347814.svg" alt="Body size 4" width="18" height="18"><br>' +
			//'5 <img src="markers/noun_Brain_2805277.svg" alt="Brain size 5" width="21" height="21"> <img src="markers/noun_Man_347814.svg" alt="Body size 5" width="21" height="21"><br>' +
			//'6 <img src="markers/noun_Brain_2805277.svg" alt="Brain size 6" width="24" height="24"> <img src="markers/noun_Man_347814.svg" alt="Body size 6" width="24" height="24"><br>' +
			//'7 <img src="markers/noun_Brain_2805277.svg" alt="Brain size 7" width="27" height="27"> <img src="markers/noun_Man_347814.svg" alt="Body size 7" width="27" height="27"><br>' +
			//'8 <img src="markers/noun_Brain_2805277.svg" alt="Brain size 8" width="30" height="30"> <img src="markers/noun_Man_347814.svg" alt="Body size 8" width="30" height="30"><br>' +
			'<table><tr style="text-align:center"><th>Age Groups</th><th>Brain</th><th>Body</th></tr>' +
			'<tr><td style="text-align:left">1 =  10.000-100.000 kya</td><td><img src="markers/noun_Brain_2805277.svg" alt="Brain size 1" width="10" height="10"></td><td><img src="markers/noun_Man_347814.svg" alt="Brain size 1" width="10" height="10"></td></tr>' +
			'<tr><td style="text-align:left">2 = 100.001-200.000 kya</td><td><img src="markers/noun_Brain_2805277.svg" alt="Brain size 1" width="12" height="12"></td><td><img src="markers/noun_Man_347814.svg" alt="Brain size 1" width="12" height="12"></td></tr>' +
			'<tr><td style="text-align:left">3 = 200.001-300.000 kya</td><td><img src="markers/noun_Brain_2805277.svg" alt="Brain size 1" width="15" height="15"></td><td><img src="markers/noun_Man_347814.svg" alt="Brain size 1" width="15" height="15"></td></tr>' +
			'<tr><td style="text-align:left">4 = 300.001-400.000 kya</td><td><img src="markers/noun_Brain_2805277.svg" alt="Brain size 1" width="18" height="18"></td><td><img src="markers/noun_Man_347814.svg" alt="Brain size 1" width="18" height="18"></td></tr>' +
			'<tr><td style="text-align:left">5 = 400.001-500.000 kya</td><td><img src="markers/noun_Brain_2805277.svg" alt="Brain size 1" width="21" height="21"></td><td><img src="markers/noun_Man_347814.svg" alt="Brain size 1" width="21" height="21"></td></tr>' +
			'<tr><td style="text-align:left">6 = 500.001-600.000 kya</td><td><img src="markers/noun_Brain_2805277.svg" alt="Brain size 1" width="24" height="24"></td><td><img src="markers/noun_Man_347814.svg" alt="Brain size 1" width="24" height="24"></td></tr>' +
			'<tr><td style="text-align:left">7 = 600.001-700.000 kya</td><td><img src="markers/noun_Brain_2805277.svg" alt="Brain size 1" width="27" height="27"></td><td><img src="markers/noun_Man_347814.svg" alt="Brain size 1" width="27" height="27"></td></tr>' +
			'<tr><td style="text-align:left">8 = 700.001-800.000 kya</td><td><img src="markers/noun_Brain_2805277.svg" alt="Brain size 1" width="30" height="30"></td><td><img src="markers/noun_Man_347814.svg" alt="Brain size 1" width="30" height="30"></td></tr>' +
			'</tr></table>'
			;
			
			return div;
		
		};

legend.addTo(map);
	
	
	
</script>
	



</body>
</html>